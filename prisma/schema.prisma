generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum UserRole {
  PRODUCER
  ADMIN
}

enum CropType {
  SOYBEANS
  CORN
  COTTON
  COFFEE
  SUGARCANE
}

model User {
  id       String   @id @default(uuid())
  name     String
  email    String   @unique
  password String
  role     UserRole @default(ADMIN)

  notifications Notification[]
  farms         Farm[]

  @@map("users")
}

model Notification {
  id          String    @id @default(uuid())
  recipientId String    @map("recipient_id")
  title       String
  content     String
  readAt      DateTime? @map("read_at")
  createdAt   DateTime  @default(now()) @map("created_at")

  recipient User @relation(fields: [recipientId], references: [id])

  @@map("notifications")
}

model Farm {
  id             String     @id @default(uuid())
  producerId     String     @map("producer_id")
  cpfCnpj        String     @unique
  producerName   String     @map("producer_name")
  farmName       String     @map("farm_name")
  city           String
  state          String
  totalArea      Float      @map("total_area") // em hectares
  arableArea     Float      @map("arable_area") // em hectares
  vegetationArea Float      @map("vegetation_area") // em hectares
  cultures       CropType[] @map("cultures")
  createdAt      DateTime   @default(now()) @map("created_at")
  updatedAt      DateTime   @updatedAt @map("updated_at")

  producer User @relation(fields: [producerId], references: [id])

  @@map("farms")
}

model FarmIndicator {
  id         String   @id @default(uuid())
  state      String
  culture    CropType
  totalFarms Int      @map("total_farms")
  totalArea  Float    @map("total_area") // em hectares
  createdAt  DateTime @default(now()) @map("created_at")

  @@map("farm_indicators")
}
